/*--------------------------------*- C++ -*----------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  1.6                                   |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    "system";
    object      controlDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

application       fastfoam;

libs              ("libuserfiniteVolume.so");

// startFrom         startTime;
startFrom         latestTime;

startTime         0.0;

startTimeMean     0.0;

startTimeCorr     0.0;

stopAt            endTime;

endTime           4.0;  // "steady state" should be acheived about 3 to 5 seconds, for single turbine
// endTime           10.0;

deltaT            0.0025; // mesh = coarse
// deltaT            0.0015; // mesh = medium1
// deltaT            0.0012; // mesh = medium2
// deltaT            0.0008; // mesh = medium3
// deltaT            0.0006; // mesh = fine

writeControl      adjustableRunTime;

writeInterval     0.02;      // write at 50 frames per second (for movies)
// writeInterval     0.004;  // testing system calls

// purgeWrite        0;
purgeWrite        3;

writeFormat       binary;
//writeFormat       ascii;

writePrecision    12;

//writeCompression  compressed;
writeCompression  uncompressed;

timeFormat        general;

timePrecision     12;

runTimeModifiable no;
// runTimeModifiable yes;

// adjustTimeStep    no;
adjustTimeStep    yes;

maxCo             0.2;
// maxCo             0.75;

maxDeltaT         10.0;


functions
  {
      
      sysCall
      {
          type systemCall;
          functionObjectLibs ( "libsystemCall.so" );
                   
          outputControl outputTime;
          outputInterval 1;

          // executeCalls 1("echo [sysCall] executeCalls: Execute system call before time iteration is done");
          
          // endCalls 1("echo [sysCall] endCalls: Finishing up with a system call, which seems to be before the write call...");
          
          writeCalls 2(
                "echo [sysCall] writeCalls: Writing to file call" 
                 
                // each write interval this script is run, for run time post-processing
                "./run-master-node-sysCall.sh"

          );

      }

  } //end functions

